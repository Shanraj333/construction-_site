{% extends "base.html" %}
{% load widget_tweaks %}
{% block content %}


<!-- Entire Wrapper for Hero + Feature Sections -->
<div x-data="{ active: 'default', section: 'default', registerForm: '' }">



  <!-- Hero Section -->
  <section class="bg-blue-900 text-white py-20">
    <div class="container mx-auto px-6 text-center relative min-h-[400px]">

      <!-- Default Hero -->
      <div
        x-show="active === 'default'"
        x-transition:enter="transition transform duration-700"
        x-transition:enter-start="translate-x-0 opacity-100"
        x-transition:leave="transition transform duration-700"
        x-transition:leave-end="-translate-x-full opacity-0"
        class="absolute inset-0"
      >
        <h1 class="text-4xl md:text-6xl font-bold mb-6 pt-20">Connecting Construction Professionals</h1>
        <p class="text-xl md:text-2xl mb-12 max-w-2xl mx-auto">
          The premier platform linking clients with skilled engineers and workers for seamless project execution.
        </p>
        <div class="flex flex-col md:flex-row justify-center space-y-4 md:space-y-0 md:space-x-6">
          <button @click="active = 'client'"
            class="bg-yellow-500 text-blue-900 px-8 py-4 rounded-lg font-bold text-lg hover:bg-yellow-400">
            I Need Services
          </button>
          <button @click="active = 'pro'"
            class="bg-white text-blue-900 px-8 py-4 rounded-lg font-bold text-lg hover:bg-gray-200">
            I Offer Services
          </button>
        </div>
      </div>

      <!-- Client Hero -->
      <div
        x-show="active === 'client'"
        x-transition:enter="transition transform duration-700"
        x-transition:enter-start="translate-x-full opacity-0"
        x-transition:leave="transition transform duration-700"
        x-transition:leave-end="-translate-x-full opacity-0"
        class="absolute inset-0"
      >
        <h1 class="text-4xl md:text-6xl font-bold mb-6 pt-20">Find the Best Professionals</h1>
        <p class="text-xl md:text-2xl mb-12 max-w-2xl mx-auto">
          Search and connect with engineers, contractors, and workers near you.
        </p>
        <div class="flex flex-col md:flex-row justify-center space-y-4 md:space-y-0 md:space-x-6">

          <button @click=" section = 'engineer';"
          class="bg-white text-blue-900 px-8 py-4 rounded-lg font-bold hover:bg-gray-200">
          Engineers
        </button>
        
        <button
        @click="section = 'contractor';"
        class="bg-white text-blue-900 px-8 py-4 rounded-lg font-bold hover:bg-gray-200">
        Contractors
      </button>
      
      <button
        @click="section = 'worker';"
        class="bg-white text-blue-900 px-8 py-4 rounded-lg font-bold hover:bg-gray-200">
        workers
      </button>
      
        </div>
        <button 
        @click="active = 'default'; section = 'default'; registerForm = ''"
        class="text-yellow-400 underline text-lg mt-6"
          >
        ← Back
        </button>

      </div>

   <!-- Professional Hero -->
<div
x-show="active === 'pro'"
x-transition:enter="transition transform duration-700"
x-transition:enter-start="translate-x-full opacity-0"
x-transition:leave="transition transform duration-700"
x-transition:leave-end="-translate-x-full opacity-0"
class="absolute inset-0"
>
<h1 class="text-4xl md:text-6xl font-bold mb-6 pt-20">Join as a Professional</h1>
<p class="text-xl md:text-2xl mb-12 max-w-2xl mx-auto">
  Choose your profession and get started with project opportunities.
</p>
<div class="flex flex-col md:flex-row justify-center space-y-4 md:space-y-0 md:space-x-6">
  <button @click="registerForm = 'engineer'; "
    class="bg-white text-blue-900 px-8 py-4 rounded-lg font-bold hover:bg-gray-200">Engineer</button>
  <button @click="registerForm = 'contractor'; "
    class="bg-white text-blue-900 px-8 py-4 rounded-lg font-bold hover:bg-gray-200">Contractors</button>
  <button @click="registerForm = 'worker'; "
    class="bg-white text-blue-900 px-8 py-4 rounded-lg font-bold hover:bg-gray-200">worker</button>
</div>
<button 
  @click="active = 'default'; section = 'default'; registerForm = ''"
  class="text-yellow-400 underline text-lg mt-6"
>
  ← Back
</button>

</div>


  </section>
 
  <!-- Features Section -->
  <section
  x-show="section === 'default' && registerForm === ''"
  x-transition:enter="transition transform duration-700"
  x-transition:enter-start="translate-x-full opacity-0"
  x-transition:leave="transition transform duration-700"
  x-transition:leave-end="-translate-x-full opacity-0"
  class="py-20 bg-white relative z-10"
>

  >
    <div class="container mx-auto px-6">
      <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">Why Choose ConstructionConnect?</h2>
      <div class="grid md:grid-cols-3 gap-8">
        <div class="bg-gray-50 p-6 rounded-lg shadow-lg text-center">
          <div class="text-blue-600 mb-4">
            <i class="fas fa-users fa-3x"></i>
          </div>
          <h3 class="text-xl font-semibold mb-2">Verified Professionals</h3>
          <p class="text-gray-600">All engineers and workers are thoroughly vetted for qualifications and experience.</p>
        </div>
        <div class="bg-gray-50 p-6 rounded-lg shadow-lg text-center">
          <div class="text-blue-600 mb-4">
            <i class="fas fa-handshake fa-3x"></i>
          </div>
          <h3 class="text-xl font-semibold mb-2">Secure Payments</h3>
          <p class="text-gray-600">Escrow payment system ensures funds are only released when work is completed.</p>
        </div>
        <div class="bg-gray-50 p-6 rounded-lg shadow-lg text-center">
          <div class="text-blue-600 mb-4">
            <i class="fas fa-star fa-3x"></i>
          </div>
          <h3 class="text-xl font-semibold mb-2">Rating System</h3>
          <p class="text-gray-600">Rate and review professionals to build trust within the community.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Engineers / contractors / workers Section -->
  <section
    id="profiles-section"
    x-cloak
    x-show="section !== 'default'"
    x-transition:enter="transition transform duration-700"
    x-transition:enter-start="translate-x-full opacity-0"
    x-transition:leave="transition transform duration-700"
    x-transition:leave-end="-translate-x-full opacity-0"
    x-init="$watch('section', value => {
    if (value !== 'default') {
      $nextTick(() => {
        setTimeout(() => {
          document.getElementById('profiles-section')?.scrollIntoView({ behavior: 'smooth' });
        }, 700); // Matches your transition duration
      });
    }
  })
"

    class="py-20 bg-white relative z-10"
  >
    <div class="container mx-auto px-6">
      <div class="flex justify-between items-center mb-8">
        <h2 class="text-3xl font-bold text-gray-800">
          <span x-text="section.charAt(0).toUpperCase() + section.slice(1)"></span>
        </h2>
        <button @click="section = 'default'" class="text-blue-800 underline">← Back to Features</button>
      </div>

      <!-- Search -->
      <form method="GET" action="" class="flex flex-col md:flex-row items-center justify-center gap-4 mb-8">
        <input type="text" name="q" placeholder="Search by name..." value="{{ request.GET.q }}"
          class="w-full md:w-1/3 px-4 py-2 border border-gray-300 rounded-lg">
        <button type="submit" class="bg-blue-800 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Search</button>
      </form>

      <!-- Profiles Section -->
  <!-- Engineers -->
  <div x-show="section === 'engineer'" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
    {% if engineers %}
      {% for profile in engineers %}
        {% include "partials/profile_card.html" with profile=profile %}
      {% endfor %}
    {% else %}
      {% with ""|center:3 as dummy %}
        {% for _ in dummy %}
          <div class="bg-gray-100 rounded-lg shadow-md p-6 animate-pulse">
            <div class="h-40 bg-gray-300 rounded mb-4 flex items-center justify-center text-gray-500">
              Awaiting Approval
            </div>
            <div class="h-4 bg-gray-300 rounded w-3/4 mb-2"></div>
            <div class="h-4 bg-gray-300 rounded w-1/2 mb-2"></div>
            <div class="h-4 bg-gray-300 rounded w-full"></div>
          </div>
        {% endfor %}
      {% endwith %}
    {% endif %}
  </div>
  



<!-- contractors -->
<div x-show="section === 'contractor'" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
  {% for profile in contractors %}
    {% include "partials/profile_card.html" with profile=profile %}
  {% endfor %}

  {% for i in "123" %}
    <div class="bg-gray-100 rounded-lg shadow-md p-6 animate-pulse">
      <div class="h-40 bg-gray-300 rounded mb-4 flex items-center justify-center text-gray-500">
        Awaiting Approval
      </div>
      <div class="h-4 bg-gray-300 rounded w-3/4 mb-2"></div>
      <div class="h-4 bg-gray-300 rounded w-1/2 mb-2"></div>
      <div class="h-4 bg-gray-300 rounded w-full"></div>
    </div>
  {% endfor %}
</div>

<!-- workers -->
<div x-show="section === 'worker'" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
  {% for profile in workers %}
    {% include "partials/profile_card.html" with profile=profile %}
  {% endfor %}

  {% for i in "123" %}
    <div class="bg-gray-100 rounded-lg shadow-md p-6 animate-pulse">
      <div class="h-40 bg-gray-300 rounded mb-4 flex items-center justify-center text-gray-500">
        Awaiting Approval
      </div>
      <div class="h-4 bg-gray-300 rounded w-3/4 mb-2"></div>
      <div class="h-4 bg-gray-300 rounded w-1/2 mb-2"></div>
      <div class="h-4 bg-gray-300 rounded w-full"></div>
    </div>
  {% endfor %}
</div>

  </section>

  <!-- Registration Forms -->
 <section
  id="registration-section"
  x-data="{ shouldScroll: false }"
  x-init="$watch('registerForm', value => {
    if (value !== '') {
      shouldScroll = true; // Set scroll flag
    }
  })"
  @transitionend.window="if (registerForm !== '' && shouldScroll) {
    shouldScroll = false; // Reset scroll flag
    const section = document.getElementById('registration-section');
    if (section) {
      const offset = -50;
      const top = section.getBoundingClientRect().top + window.pageYOffset + offset;
      window.scrollTo({ top, behavior: 'smooth' });
    }
  }"
  x-show="registerForm !== ''"
  x-transition:enter="transition transform duration-700"
  x-transition:enter-start="translate-x-full opacity-0"
  x-transition:leave="transition transform duration-700"
  x-transition:leave-end="-translate-x-full opacity-0"
  class="py-20 bg-white relative z-10"
>


<div class="container mx-auto px-6">
  <div class="flex justify-between items-center mb-8">
    <h2 class="text-3xl font-bold text-gray-800">
      <span x-text="registerForm.charAt(0).toUpperCase() + registerForm.slice(1) + ' Registration'"></span>
    </h2>
    <button @click="registerForm = ''; active = 'pro'" class="text-blue-800 underline">← Back</button>
  </div>

  <!-- Engineer Registration Form -->
  <div x-show="registerForm === 'engineer'">
    {% include 'includes/register_engineer_form.html' %}
  </div>

  <!-- contractor Registration Form -->
  <div x-show="registerForm === 'contractor'">
    {% include 'includes/register_contractor_form.html' %}
  </div>

  <!-- worker Registration Form -->
  <div x-show="registerForm === 'worker'">
    {% include 'includes/register_worker_form.html' %}
  </div>
</div>
</section>

</div>



  
<!-- How It Works -->
<section
  id="how-it-works"
  x-show="section === 'default'"
  x-transition:leave="transition transform duration-700"
  x-transition:leave-end="-translate-x-full opacity-0"
  class="py-20 bg-gray-100"
>
  <div class="container mx-auto px-6">
    <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">How It Works</h2>
    <div class="grid md:grid-cols-3 gap-12 text-center">
      <div>
        <div class="bg-blue-800 text-white rounded-full h-16 w-16 flex items-center justify-center text-2xl font-bold mb-4 mx-auto">1</div>
        <h3 class="text-xl font-semibold mb-2">Create Your Profile</h3>
        <p class="text-gray-600">Sign up as a client or professional and complete your profile.</p>
      </div>
      <div>
        <div class="bg-blue-800 text-white rounded-full h-16 w-16 flex items-center justify-center text-2xl font-bold mb-4 mx-auto">2</div>
        <h3 class="text-xl font-semibold mb-2">Post or Find Projects</h3>
        <p class="text-gray-600">Clients post projects, professionals browse and submit bids.</p>
      </div>
      <div>
        <div class="bg-blue-800 text-white rounded-full h-16 w-16 flex items-center justify-center text-2xl font-bold mb-4 mx-auto">3</div>
        <h3 class="text-xl font-semibold mb-2">Collaborate & Complete</h3>
        <p class="text-gray-600">Work together using our platform's tools and complete the project.</p>
      </div>
    </div>
  </div>
</section>



    <!-- Feedback Display -->
    <!-- Feedback Section -->
<section class="py-20 bg-white" id="feedback">
  <div class="container mx-auto px-6">
    <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">User Feedback</h2>

    <!-- Display Feedback -->
    <div class="grid md:grid-cols-2 gap-8 mb-12">
      {% for fb in feedbacks %}
        <div class="bg-gray-100 p-6 rounded-xl shadow-sm">
          <p class="text-gray-700 italic">“{{ fb.message }}”</p>
          <div class="text-sm text-gray-500 mt-4 text-right">- {{ fb.name }}</div>
        </div>
      {% empty %}
        <p class="text-center text-gray-600 col-span-full">No feedback yet. Be the first to leave one!</p>
      {% endfor %}
    </div>

    <!-- Feedback Form -->
    <div class="max-w-xl mx-auto bg-gray-50 p-8 rounded-xl shadow">
      <h3 class="text-xl font-semibold text-gray-700 mb-4 text-center">Leave Your Feedback</h3>
      <form method="POST" action="#feedback">
        {% csrf_token %}
        <div class="mb-4">
          <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Your Name</label>
          {{ form.name|add_class:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-blue-300" }}
        </div>
        <div class="mb-4">
          <label for="message" class="block text-sm font-medium text-gray-700 mb-1">Your Message</label>
          {{ form.message|add_class:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:ring-blue-300" }}
        </div>
        <div class="text-center">
          <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">Submit</button>
        </div>
      </form>
    </div>
  </div>
</section>


{% endblock %}
